<!DOCTYPE html><html><head><meta content="text/html; charset=utf-8" http-equiv="Content-Type" /><meta content="width=device-width, initial-scale=1" name="viewport" /><!--replace-start-0--><!--replace-start-5--><!--replace-start-8--><title>When to use structs or interfaces - Wiki of Kalle</title><!--replace-end-8--><!--replace-end-5--><!--replace-end-0--><link href="https://cdn.jsdelivr.net/npm/fomantic-ui@2.8.7/dist/semantic.min.css" rel="stylesheet" /><link href="https://fonts.googleapis.com/css?family=Merriweather|Libre+Franklin|Roboto+Mono&amp;display=swap" rel="stylesheet" /><!--replace-start-1--><!--replace-start-4--><!--replace-start-7--><div class="pandoc-raw-html-block"><!-- Dark theme -->
<link href="/static/dark-theme.css" rel="stylesheet">

<!-- MathJax, math rendering -->
<script async="" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>

<!-- Syntax highlighting -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.23.0/themes/prism-okaidia.min.css" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.23.0/components/prism-core.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.23.0/plugins/autoloader/prism-autoloader.min.js"></script>
<!-- End of head.html -->
</div><link href="https://raw.githubusercontent.com/srid/neuron/master/assets/neuron.svg" rel="icon" /><meta content="Kalle Jillheden" name="author" /><meta content="The Go language has two main data types that you fondle around with: interfaces and structs." name="description" /><link href="https://wiki.jillejr.tech/when-to-use-structs-or-interfaces" rel="canonical" /><meta content="When to use structs or interfaces" property="og:title" /><meta content="Wiki of Kalle" property="og:site_name" /><meta content="article" property="og:type" /><script type="application/ld+json">[{"@context":"https://schema.org","itemListElement":[{"name":"Creating a lasting Go project","item":"https://wiki.jillejr.tech/creating-a-lasting-go-project","@type":"ListItem","position":1}],"@type":"BreadcrumbList"},{"@context":"https://schema.org","itemListElement":[{"name":"lang/","item":"https://wiki.jillejr.tech/lang","@type":"ListItem","position":1},{"name":"Go","item":"https://wiki.jillejr.tech/go","@type":"ListItem","position":2}],"@type":"BreadcrumbList"},{"@context":"https://schema.org","itemListElement":[{"name":"people/","item":"https://wiki.jillejr.tech/people","@type":"ListItem","position":1},{"name":"Rob Pike","item":"https://wiki.jillejr.tech/rob-pike","@type":"ListItem","position":2},{"name":"Go","item":"https://wiki.jillejr.tech/go","@type":"ListItem","position":3}],"@type":"BreadcrumbList"}]</script><style type="text/css">body{background-color:#eeeeee !important;font-family:"Libre Franklin", serif !important}body .ui.container{font-family:"Libre Franklin", serif !important}body h1, h2, h3, h4, h5, h6, .ui.header, .headerFont{font-family:"Merriweather", sans-serif !important}body code, pre, tt, .monoFont{font-family:"Roboto Mono","SFMono-Regular","Menlo","Monaco","Consolas","Liberation Mono","Courier New", monospace !important}body div.z-index p.info{color:#808080}body div.z-index ul{list-style-type:square;padding-left:1.5em}body div.z-index .uplinks{margin-left:0.29999em}body .zettel-content h1#title-h1{background-color:rgba(0,181,173,0.1)}body nav.bottomPane{background-color:rgba(0,181,173,2.0e-2)}body div#footnotes{border-top-color:#00b5ad}body p{line-height:150%}body img{max-width:100%}body .deemphasized{font-size:0.94999em}body .deemphasized:hover{opacity:1}body .deemphasized:not(:hover){opacity:0.69999}body .deemphasized:not(:hover) a{color:#808080 !important}body div.container.universe{padding-top:1em}body div.zettel-view ul{padding-left:1.5em;list-style-type:square}body div.zettel-view .pandoc .highlight{background-color:#ffff00}body div.zettel-view .pandoc .ui.disabled.fitted.checkbox{margin-right:0.29999em;vertical-align:middle}body div.zettel-view .zettel-content .metadata{margin-top:1em}body div.zettel-view .zettel-content .metadata div.date{text-align:center;color:#808080}body div.zettel-view .zettel-content h1{padding-top:0.2em;padding-bottom:0.2em;text-align:center}body div.zettel-view .zettel-content h2{border-bottom:solid 1px #4682b4;margin-bottom:0.5em}body div.zettel-view .zettel-content h3{margin:0px 0px 0.4em 0px}body div.zettel-view .zettel-content h4{opacity:0.8}body div.zettel-view .zettel-content div#footnotes{margin-top:4em;border-top-style:groove;border-top-width:2px;font-size:0.9em}body div.zettel-view .zettel-content div#footnotes ol > li > p:only-of-type{display:inline;margin-right:0.5em}body div.zettel-view .zettel-content aside.footnote-inline{width:30%;padding-left:15px;margin-left:15px;float:right;background-color:#d3d3d3}body div.zettel-view .zettel-content .overflows{overflow:auto}body div.zettel-view .zettel-content code{margin:auto auto auto auto;font-size:100%}body div.zettel-view .zettel-content p code, li code, ol code{padding:0.2em 0.2em 0.2em 0.2em;background-color:#f5f2f0}body div.zettel-view .zettel-content pre{overflow:auto}body div.zettel-view .zettel-content dl dt{font-weight:bold}body div.zettel-view .zettel-content blockquote{background-color:#f9f9f9;border-left:solid 10px #cccccc;margin:1.5em 0px 1.5em 0px;padding:0.5em 10px 0.5em 10px}body div.zettel-view .zettel-content.raw{background-color:#dddddd}body .ui.label.zettel-tag{color:#000000}body .ui.label.zettel-tag a{color:#000000}body nav.bottomPane ul.backlinks > li{padding-bottom:0.4em;list-style-type:disc}body nav.bottomPane ul.context-list > li{list-style-type:lower-roman}body .footer-version img{-webkit-filter:grayscale(100%);-moz-filter:grayscale(100%);-ms-filter:grayscale(100%);-o-filter:grayscale(100%);filter:grayscale(100%)}body .footer-version img:hover{-webkit-filter:grayscale(0%);-moz-filter:grayscale(0%);-ms-filter:grayscale(0%);-o-filter:grayscale(0%);filter:grayscale(0%)}body .footer-version, .footer-version a, .footer-version a:visited{color:#808080}body .footer-version a{font-weight:bold}body .footer-version{margin-top:1em !important;font-size:0.69999em}@media only screen and (max-width: 768px){body div#zettel-container{margin-left:0.4em !important;margin-right:0.4em !important}}body span.zettel-link-container span.zettel-link a{color:#00b5ad;font-weight:bold;text-decoration:none}body span.zettel-link-container span.zettel-link a:hover{background-color:rgba(0,181,173,0.1)}body span.zettel-link-container span.extra{color:auto}body span.zettel-link-container.errors{border:solid 1px #ff0000}body span.zettel-link-container.errors span.zettel-link a:hover{text-decoration:none !important;cursor:not-allowed}body [data-tooltip]:after{font-size:0.69999em}body div.tag-tree div.node{font-weight:bold}body div.tag-tree div.node a.inactive{color:#555555}body .tree.flipped{-webkit-transform:rotate(180deg);-moz-transform:rotate(180deg);-ms-transform:rotate(180deg);-o-transform:rotate(180deg);transform:rotate(180deg)}body .tree{overflow:auto}body .tree ul.root{padding-top:0px;margin-top:0px}body .tree ul{position:relative;padding:1em 0px 0px 0px;white-space:nowrap;margin:0px auto 0px auto;text-align:center}body .tree ul::after{content:"";display:table;clear:both}body .tree ul:last-child{padding-bottom:0.1em}body .tree li{display:inline-block;vertical-align:top;text-align:center;list-style-type:none;position:relative;padding:1em 0.5em 0em 0.5em}body .tree li::before{content:"";position:absolute;top:0px;right:50%;border-top:solid 2px #cccccc;width:50%;height:1.19999em}body .tree li::after{content:"";position:absolute;top:0px;right:50%;border-top:solid 2px #cccccc;width:50%;height:1.19999em}body .tree li::after{right:auto;left:50%;border-left:solid 2px #cccccc}body .tree li:only-child{padding-top:0em}body .tree li:only-child::after{display:none}body .tree li:only-child::before{display:none}body .tree li:first-child::before{border-style:none;border-width:0px}body .tree li:first-child::after{border-radius:5px 0px 0px 0px}body .tree li:last-child::after{border-style:none;border-width:0px}body .tree li:last-child::before{border-right:solid 2px #cccccc;border-radius:0px 5px 0px 0px}body .tree ul ul::before{content:"";position:absolute;top:0px;left:50%;border-left:solid 2px #cccccc;width:0px;height:1.19999em}body .tree li div.forest-link{border:solid 2px #cccccc;padding:0.2em 0.29999em 0.2em 0.29999em;text-decoration:none;display:inline-block;border-radius:5px 5px 5px 5px;color:#333333;position:relative;top:2px}body .tree.flipped li div.forest-link{-webkit-transform:rotate(180deg);-moz-transform:rotate(180deg);-ms-transform:rotate(180deg);-o-transform:rotate(180deg);transform:rotate(180deg)}</style><!--replace-end-7--><!--replace-end-4--><!--replace-end-1--></head><body><div class="ui fluid container universe"><!--replace-start-2--><!--replace-start-3--><!--replace-start-6--><nav class="flipped tree deemphasized" id="zettel-uptree" style="transform-origin: 50%"><ul class="root"><li><ul><li><div class="forest-link"><span class="zettel-link-container"><span class="zettel-link" title="2021-01-24T14:54"><a href="go">Go</a></span></span></div><ul><li><div class="forest-link"><span class="zettel-link-container"><span class="zettel-link" title="2021-02-08T19:15"><a href="rob-pike">Rob Pike</a></span></span></div><ul><li><div class="forest-link"><span class="zettel-link-container"><span class="zettel-link"><a href="people">people/</a></span></span></div></li></ul></li><li><div class="forest-link"><span class="zettel-link-container"><span class="zettel-link"><a href="lang">lang/</a></span></span></div></li></ul></li><li><div class="forest-link"><span class="zettel-link-container"><span class="zettel-link" title="2021-01-24T12:24"><a href="creating-a-lasting-go-project">Creating a lasting Go project</a></span></span></div></li></ul></li></ul></nav><div class="ui text container" id="zettel-container" style="position: relative"><div class="zettel-view"><article class="ui raised attached segment zettel-content"><div class="pandoc"><h1 id="title-h1">When to use structs or interfaces</h1><p>The Go language has two main data types that you fondle around with: interfaces and structs.</p><pre><code class="go language-go">type MyStruct struct {
    Field1 string
    Field2 int
}

type MyInterface interface {
    Func1(string)
    Func2() string
}</code></pre><h2 id="when-to-use-structs">When to use structs</h2><p>A <code>struct</code> type can hold fields, but cannot be extended with more information. It’s a static data-container.</p><p>This means that you should be careful when using structs as a library consumer of your project may want to add data to their data containers here and there depending on their use case.</p><h2 id="structs-configs">Structs: Configs</h2><p>A common “good practice” use case for structs are configs. For example, here’s a config for some generic web hosting service:</p><pre><code class="go language-go">package server

type Config struct {
    Port     int
    Hostname string
}</code></pre><p>Good example of this is the <code>http.Request</code>, which is a configuration of how a HTTP request should be sent.</p><p>This can however go bad when you want to let the library consumer to define what database to use. MsSQL uses connection strings, Postgres uses username+password; how do you support both scenarios without bloating up your config with a lot of fields that will be unused in either case?</p><p>This is where you’d mix the config with some interfaces and let the consumers initialize and define their own configs for their database implementation. Not all configs should be declared by you, but generally speaking: all configs should be structs.</p><h2 id="structs-return-types">Structs: Return types</h2><p>If you library accepts a structs as an argument, then the library consumer must use your data types and cannot extend the configurations of their custom behavior in any clean way.</p><p>But return types are a different story. The data returned from a method should not need to be altered. Good example of this is the <code>http.Response</code> type. A HTTP response does always have a status code, a body, list of headers, et.al. A library consumer should not need to extend the data in this response, or otherwise they’re using the wrong library to begin with.</p><h2 id="interfaces-behavior">Interfaces: Behavior</h2><p>Any time you need to declare some behavior, you should do that via an interface. Doing that will make the project both more testable and more extensible.</p><p>Consider the web server with database example mentioned above. If we want to access the database, we could either <em>lazily</em> just hardcode a MySQL dependency into the functions:</p><pre><code class="go language-go">type Config struct {
    DatabaseURL   string
    MySQLUsername string
    MySQLPassword string
}

func FetchUserById(config Config, id int) (User, error) {
    // This is pseudo-code. Not tested nor using real APIs
    conn := db.Connection(config.DatabaseURL, config.MySQLUsername, config.MySQLPassword)
    user := conn.Select(&quot;Users&quot;).Where(&quot;UserId = ?&quot;, id).Single()
    return user, nil
}</code></pre><p>The above locks the library user to</p><ol><li>Use MySQL</li><li>Provide MySQL credentials through the library’s <code>Config</code> struct</li></ol><p>A cleaner and more extensible solution would be:</p><pre><code class="go language-go">type Config struct {
    DB *Database
}

type Database interface {
    FetchUserById(int) (User, error)
}

type MySQLDatabase struct {
    Url      string
    Username string
    Password string
}

func (db *MySQLDatabase) FetchUserById(id int) (User, error) {
    // This is pseudo-code. Not tested nor using real APIs
    conn := db.Connection(db.Url, db.Username, db.Password)
    user := conn.Select(&quot;Users&quot;).Where(&quot;UserId = ?&quot;, id).Single()
    return user, nil
}

func FetchUserById(config Config, id int) (User, error) {
    return config.DB.FetchUserById(id)
}</code></pre><p>The type <code>MySQLDatabase</code> is in this case an implementation provided by the library, but the library consumer can very well just <em>not</em> use that implementation and instead add their own <code>Database</code> implementation that may very well just use Postgres, some in-memory store, or just direct file access.</p><p>This is also talked about in <span class="zettel-link-container folge"><span class="zettel-link" title="2021-01-24T12:31"><a href="what-to-focus-on-in-a-go-project">What to focus on in a Go project</a><span data-nosnippet="" style="user-select: none; color: gray" title="Folgezettel">#</span></span></span> in its section about integration and extensibility. It’s more work, but it’s worth it.</p><h2 id="interfaces-errors">Interfaces: errors</h2><p>Errors is a classic example of interfaces. The <code>error</code> type is <strong>always</strong> what you want to use when returning errors.</p><p>The <code>error</code> interface looks like this:</p><pre><code class="go language-go">type error interface {
    Error() string
}</code></pre><p>This means that the error you produce in your code can conform to this interface and then store any information you’d want in it.</p><p>The most basic implementation of this is the error you’d find in the <code>errors</code> standard package:</p><pre><code class="go language-go">package errors

// New returns an error that formats as the given text.
// Each call to New returns a distinct error value even if the text is identical.
func New(text string) error {
	return &amp;errorString{text}
}

// errorString is a trivial implementation of error.
type errorString struct {
	s string
}

func (e *errorString) Error() string {
	return e.s
}</code></pre><p>It just stores a string. And that’s it.</p><p>This is very benifitial in some cases such as if you run a process and have it error on non-zero exit code, then the error could have an integer field with the exit code that the consumer could take use of instead of trying to parse that value out from the error message string, which would be very volatile of a solution.</p><h2 id="references">References</h2><ul><li>Mike Van Sickle. (2019, July 29). <em>Deep Dive into Go Packages</em> [Course]. Pluralsight. <a href="https://www.pluralsight.com/courses/go-packages-deep-dive">https://www.pluralsight.com/courses/go-packages-deep-dive</a></li></ul></div><div class="metadata"><div class="date" title="Zettel date"><time datetime="2021-01-24T13:28">2021-01-24</time></div></div></article><nav class="ui attached segment deemphasized backlinksPane"><h3 class="ui header"><span title="Backlinks from folgezettel parents">Uplinks</span></h3><ul class="backlinks"><li><span class="zettel-link-container folge"><span class="zettel-link" title="2021-01-24T14:54"><a href="go">Go</a><span data-nosnippet="" style="user-select: none; color: gray" title="Folgezettel">#</span></span></span><ul class="context-list" style="zoom: 85%;"><li class="item"><div class="pandoc"><em>Parent directory zettel</em></div></li></ul></li><li><span class="zettel-link-container folge"><span class="zettel-link" title="2021-01-24T12:24"><a href="creating-a-lasting-go-project">Creating a lasting Go project</a><span data-nosnippet="" style="user-select: none; color: gray" title="Folgezettel">#</span></span></span><ul class="context-list" style="zoom: 85%;"></ul></li></ul></nav><nav class="ui attached segment deemphasized bottomPane"><div><span class="ui basic label zettel-tag" title="Tag">go/best practices in golang</span><span class="ui basic label zettel-tag" title="Tag">go/create a lasting go project</span><span class="ui basic label zettel-tag" title="Tag">go/writing idiomatic golang code</span><span class="ui basic label zettel-tag" title="Tag">root/lang/go</span></div></nav><div class="ui bottom attached icon compact inverted menu teal"><!--replace-start-9--><a class="item" href="." title="Home"><i class="home icon"></i></a><!--replace-end-9--><a class="item" href="https://github.com/jilleJr/wiki/blob/main/./lang/go/when-to-use-structs-or-interfaces.md" title="Edit this page"><i class="edit icon"></i></a><a class="right item" href="impulse" title="Open Impulse"><i class="wave square icon"></i></a></div></div></div><!--replace-end-6--><!--replace-end-3--><!--replace-end-2--><div class="ui center aligned container footer-version"><div class="ui tiny image"><a href="https://neuron.zettel.page"><img alt="logo" src="https://raw.githubusercontent.com/srid/neuron/master/assets/neuron.svg" title="Generated by Neuron 1.9.22.2" /></a></div></div></div></body></html>